<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>X 참여 대시보드</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=Noto+Sans+KR:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/xbot.css" />
  </head>
  <body>
    <div class="bg-grain" aria-hidden="true"></div>
    <main class="dashboard">
      <header class="hero panel">
        <div>
          <p class="eyebrow">HUMAN-IN-THE-LOOP</p>
          <h1>X 참여 어시스턴트</h1>
          <p class="subtitle">팔로잉 글/이미지 후보를 보고, 승인한 건만 좋아요/댓글을 실행합니다.</p>
        </div>
        <div class="hero-badges">
          <a class="badge" href="/xbot">수동 모드로 이동</a>
          <span id="badgeScanReady" class="badge">scan 준비 확인 중</span>
          <span id="badgeApproveReady" class="badge">approve 준비 확인 중</span>
          <span id="badgeDryRun" class="badge">dry-run 확인 중</span>
        </div>
      </header>

      <section class="panel controls">
        <div class="controls-row">
          <button id="scanButton" class="btn btn-primary" type="button">후보 스캔</button>
          <button id="refreshButton" class="btn" type="button">새로고침</button>
          <button id="clearLogButton" class="btn" type="button">로그 비우기</button>
        </div>

        <div class="controls-row controls-row-meta">
          <label class="switch-label">
            <input id="autoRefreshToggle" type="checkbox" checked />
            15초 자동 새로고침
          </label>

          <label>
            상태
            <select id="statusFilter">
              <option value="pending" selected>pending</option>
              <option value="all">all</option>
              <option value="sent">sent</option>
              <option value="rejected">rejected</option>
              <option value="failed">failed</option>
              <option value="approved_dry_run">approved_dry_run</option>
            </select>
          </label>

          <label>
            승인 쿨다운(초)
            <input id="cooldownInput" type="number" min="0" step="1" value="45" />
          </label>

          <label>
            개수
            <select id="limitSelect">
              <option value="50">50</option>
              <option value="100" selected>100</option>
              <option value="200">200</option>
              <option value="500">500</option>
            </select>
          </label>
        </div>

        <div class="summary" id="summaryText">로딩 중...</div>
      </section>

      <section class="panel">
        <div class="panel-head">
          <h2>후보 목록</h2>
          <span id="lastUpdated" class="muted">-</span>
        </div>
        <div id="candidateList" class="candidate-list"></div>
      </section>

      <section class="panel">
        <div class="panel-head">
          <h2>실행 로그</h2>
        </div>
        <pre id="logOutput" class="log-output">대기 중...</pre>
      </section>
    </main>

    <template id="candidateTemplate">
      <article class="candidate-card">
        <div class="card-head">
          <div>
            <h3 class="candidate-id"></h3>
            <p class="candidate-meta"></p>
          </div>
          <span class="status-pill"></span>
        </div>

        <a class="post-link" target="_blank" rel="noopener noreferrer">원문 보기</a>
        <p class="post-text"></p>

        <div class="metric-row">
          <div class="metric-item">
            <span>미디어 분석</span>
            <strong class="media-summary">-</strong>
          </div>
          <div class="metric-item">
            <span>기본 지표</span>
            <strong class="post-metrics">-</strong>
          </div>
        </div>

        <label class="field-label" for="">댓글 초안</label>
        <textarea class="reply-input" rows="3"></textarea>

        <div class="card-actions">
          <label class="switch-label">
            <input class="like-toggle" type="checkbox" checked />
            승인 시 좋아요
          </label>
          <div class="action-buttons">
            <button class="btn btn-small btn-approve" type="button">승인 실행</button>
            <button class="btn btn-small btn-danger btn-reject" type="button">거절</button>
          </div>
        </div>
      </article>
    </template>

    <script type="module" src="/xbot.js"></script>
  </body>
</html>
